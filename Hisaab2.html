<!DOCTYPE html>
<html>
<head>
  <title>Multiple Excel Tables</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
    }

    .section-row {
      display: flex;
      gap: 20px;
      margin-bottom: 40px;
      flex-wrap: wrap;
    }

    .table-container {
      min-width: 400px;
    }

    .items-table {
      flex: 3;
    }

    .expenses-table {
      flex: 1;
    }

    table {
      border-collapse: collapse;
      width: 100%;
    }

    th, td {
      border: 1px solid #ccc;
      padding: 0;
      height: 30px;
    }

    input {
      width: 100%;
      height: 100%;
      border: none;
      padding: 5px;
      text-align: center;
      font-size: 14px;
      font-family: inherit;
      background-color: transparent;
      -moz-appearance: textfield;
    }

    input::-webkit-outer-spin-button,
    input::-webkit-inner-spin-button {
      -webkit-appearance: none;
      margin: 0;
    }

    input:focus {
      outline: none;
      background-color: transparent;
    }

    th {
      background-color: #f2f2f2;
    }

    h3 {
      margin-bottom: 10px;
    }
  </style>
</head>
<body>

<!-- Section 1 -->
<div class="section-row">
  <div class="table-container items-table">
    <h3><input type="date"/></h3>
    <table>
      <thead>
        <tr>
          <th>Item Name</th>
          <th>YB</th>
          <th>TR</th>
          <th>Total</th>
          <th>TB</th>
          <th>T sale</th>
          <th>Total Amount</th>
        </tr>
      </thead>
      <tbody id="items-body">
        <!-- Rows generated by JavaScript -->
      </tbody>
    </table>

<!-- Small Table Aligned Under Columns F and G -->
<div style="display: flex; justify-content: flex-end; margin-top: 10px;">
  <table style="border-collapse: collapse; width: 250px;">
    <tbody id="damaged-ps">
      <tr>
	<td>Total</td>
        <td><input type="number" oninput="damagedPS()" /></td>
      </tr>
      <tr>
	<td>Damaged</td>
        <td><input type="number" oninput="damagedPS()" /></td>
      </tr>
      <tr>
	<td>PS</td>
        <td><input type="number" oninput="damagedPS()" /></td>
      </tr>
      <tr>
        <th>Total:</th>
        <td id="damagedps-table-total" style="text-align: center;">0</td>
      </tr>
    </tbody>
  </table>
</div>

<div style="display: flex; justify-content: flex-end; margin-top: 10px;">
  <table style="border-collapse: collapse; width: 300px;">
    <tbody id="tea-coffee">
      <tr data-multiplier="20">
        <td>Tea</td>
        <td><input type="number" oninput="updateTeaCoffeeTotals()" /></td>
        <td class="result-cell">0</td>
      </tr>
      <tr data-multiplier="25">
        <td>Coffee</td>
        <td><input type="number" oninput="updateTeaCoffeeTotals()" /></td>
        <td class="result-cell">0</td>
      </tr>
      <tr>
        <td></td>
        <th>Total:</th>
        <td id="Tea-coffee-table-total" style="text-align: center;">0</td>
      </tr>
    </tbody>
  </table>
</div>



  </div>

  <div class="table-container expenses-table">
    <h3>Expenditure</h3>
    <table id="expenditure-table">
      <tr><th>Salary</th><td><input type="number" oninput="calculateExpenditure()" /></td></tr>
      <tr><th>Bills</th><td><input type="number" oninput="calculateExpenditure()" /></td></tr>
      <tr><th>Wages</th><td><input type="number" oninput="calculateExpenditure()" /></td></tr>
      <tr><th></th><td><input type="number" oninput="calculateExpenditure()" /></td></tr>
      <tr><th></th><td><input type="number" oninput="calculateExpenditure()" /></td></tr>
      <tr><th>Total</th><td><input type="number" id="expenditure-total" readonly /></td></tr>
    </table>
  </div>
</div>

<script>
  const items = ['V. Samosa', 'Samosa', 'Tea', 'Coffee', 'Dil Thus cardia'];
  const multipliers = [6, 15, 20, 25, 90];
  const numRows = items.length;
  const tbody = document.getElementById('items-body');

  for (let i = 0; i < numRows; i++) {
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <th>${items[i]}</th>
      <td><input type="number" oninput="calculateRow(this)" /></td>
      <td><input type="number" oninput="calculateRow(this)" /></td>
      <td><input type="number" readonly /></td>
      <td><input type="number" oninput="calculateRow(this)" /></td>
      <td><input type="number" readonly /></td>
      <td><input type="number" readonly /></td>
    `;
    tbody.appendChild(tr);
  }

  function calculateRow(input) {
  const row = input.closest('tr');
  const allRows = Array.from(document.querySelectorAll('#items-body tr'));
  const rowIndex = allRows.indexOf(row);
  const inputs = row.querySelectorAll('input');

  const a = parseFloat(inputs[0].value) || 0;
  const b = parseFloat(inputs[1].value) || 0;
  const d = parseFloat(inputs[3].value) || 0;

  const c = a + b;
  const e = c - d;
  const f = e * (multipliers[rowIndex] || 1);

  inputs[2].value = c;
  inputs[4].value = e;
  inputs[5].value = f;

  calculateTotalAmount();
}

function calculateTotalAmount() {
  const rows = document.querySelectorAll('#items-body tr');
  let sum = 0;
  rows.forEach(row => {
    const lastCellInput = row.querySelectorAll('input')[5];
    sum += parseFloat(lastCellInput.value) || 0;
  });
  document.getElementById('grand-total-cell').textContent = sum.toFixed(2);
}

function damagedPS() {
  const inputs = document.querySelectorAll('#small-table-body tr input[type="number"]:not([readonly])');
  let sum = 0;
  inputs.forEach(input => {
    sum += parseFloat(input.value) || 0;
  });
  document.getElementById('damagedps-table-total').textContent = sum.toFixed(2);
}

function updateTeaCoffeeTotals() {
  const rows = document.querySelectorAll('#tea-coffee tr');
  let sum = 0;

  rows.forEach(row => {
    const input = row.querySelector('input');
    const resultCell = row.querySelector('.result-cell');
    const multiplier = parseFloat(row.dataset.multiplier) || 0;

    if (input && resultCell) {
      const value = parseFloat(input.value) || 0;
      const calculated = value * multiplier;
      resultCell.textContent = calculated.toFixed(0);
      sum += calculated;
    }
  });

  document.getElementById('Tea-coffee-table-total').textContent = sum.toFixed(0);
}


  function calculateExpenditure() {
    const table = document.getElementById('expenditure-table');
    const inputs = table.querySelectorAll('input:not([readonly])');
    let total = 0;
    inputs.forEach(input => {
      total += parseFloat(input.value) || 0;
    });
    document.getElementById('expenditure-total').value = total;
  }
</script>

</body>
</html>
